test_pipeonce987:
  default_args:
    owner: 'tilin'
    start_date: 2023-05-27T12:00:00
    timezone: "Asia/Shanghai"
    retries: 1
    email: [
      'tilin@wish.com'
    ]
    email_on_failure: 'True'
    email_on_retry: 'False'
    catchup: 'True'
  schedule_interval: '@daily'
  concurrency: 3
  max_active_runs: 3
  default_view: 'tree' 
  orientation: 'LR'  
  description: 'mongo dump demo'
  tasks:        
    # fpl.from_order:
    #   operator: airflow.providers.cncf.kubernetes.operators.kubernetes_pod.KubernetesPodOperator
    #   pod_template_file: '/opt/airflow/dags/repo/pod_template_files/payment_pipeline.yaml'
    #   get_logs: True
    #   labels: 
    #     task_id: "t1"
    #     dag_id: "mongo_dump_orders_bag_test"
    #   cmds: [ 
    #     "python", 
    #     "/home/app/wishpost_payment_pipeline/exp_entrypoint/dosql.py",
    #   ]
    #   arguments : [
    #     "--date={{ execution_date.strftime('%Y-%m-%dT%H:%M:%S%z') }}",
    #     "--biz_type=fpl",
    #     "--tbl_type=from_order",
    #   ]
    fpl.from_order_raw:
      operator: airflow.providers.cncf.kubernetes.operators.kubernetes_pod.KubernetesPodOperator
      pod_template_file: '/opt/airflow/dags/repo/pod_template_files/payment_pipeline.yaml'
      get_logs: True
      labels: 
        task_id: "fpl.from_order_raw"
        dag_id: "test_pipeonce"
      cmds: [ 
        "python", 
        "/home/app/wishpost_payment_pipeline/exp_entrypoint/dosql.py",
      ]
      arguments : [
        "--date={{ execution_date.strftime('%Y-%m-%dT%H:%M:%S%z') }}",
        "--biz_type=fpl",
        "--tbl_type=from_order_raw",
      ]
    fpl.refund_origin:
      operator: airflow.providers.cncf.kubernetes.operators.kubernetes_pod.KubernetesPodOperator
      pod_template_file: '/opt/airflow/dags/repo/pod_template_files/payment_pipeline.yaml'
      get_logs: True
      labels: 
        task_id: "fpl.refund_origin"
        dag_id: "test_pipeonce"
      cmds: [ 
        "python", 
        "/home/app/wishpost_payment_pipeline/exp_entrypoint/dosql.py",
      ]
      arguments : [
        "--date={{ execution_date.strftime('%Y-%m-%dT%H:%M:%S%z') }}",
        "--biz_type=fpl",
        "--tbl_type=refund_origin",
        "--public=True"
      ]
      dependencies: [fpl.from_order]
    fpl.from_order:
      operator: airflow.providers.cncf.kubernetes.operators.kubernetes_pod.KubernetesPodOperator
      pod_template_file: '/opt/airflow/dags/repo/pod_template_files/payment_pipeline.yaml'
      get_logs: True
      labels: 
        task_id: "fpl.from_order"
        dag_id: "test_pipeonce"
      cmds: [ 
        "python", 
        "/home/app/wishpost_payment_pipeline/exp_entrypoint/dosql.py",
      ]
      arguments : [
        "--date={{ execution_date.strftime('%Y-%m-%dT%H:%M:%S%z') }}",
        "--biz_type=fpl",
        "--tbl_type=from_order",
      ]
      dependencies: [lcl_124.allocate, fpl.from_order_raw]
    fpl.mapping:
      operator: airflow.providers.cncf.kubernetes.operators.kubernetes_pod.KubernetesPodOperator
      pod_template_file: '/opt/airflow/dags/repo/pod_template_files/payment_pipeline.yaml'
      get_logs: True
      labels: 
        task_id: "fpl.mapping"
        dag_id: "test_pipeonce"
      cmds: [ 
        "python", 
        "/home/app/wishpost_payment_pipeline/exp_entrypoint/dosql.py",
      ]
      arguments : [
        "--date={{ execution_date.strftime('%Y-%m-%dT%H:%M:%S%z') }}",
        "--biz_type=fpl",
        "--tbl_type=mapping",
      ]
      dependencies: [fpl.from_order]
    fpl.allocate_raw:
      operator: airflow.providers.cncf.kubernetes.operators.kubernetes_pod.KubernetesPodOperator
      pod_template_file: '/opt/airflow/dags/repo/pod_template_files/payment_pipeline.yaml'
      get_logs: True
      labels: 
        task_id: "fpl.allocate_raw"
        dag_id: "test_pipeonce"
      cmds: [ 
        "python", 
        "/home/app/wishpost_payment_pipeline/exp_entrypoint/dosql.py",
      ]
      arguments : [
        "--date={{ execution_date.strftime('%Y-%m-%dT%H:%M:%S%z') }}",
        "--biz_type=fpl",
        "--tbl_type=allocate_raw",
        "--public=True"
      ]
      dependencies: [fpl.mapping, fpl.refund_origin]
    fpl.allocate:
      operator: airflow.providers.cncf.kubernetes.operators.kubernetes_pod.KubernetesPodOperator
      pod_template_file: '/opt/airflow/dags/repo/pod_template_files/payment_pipeline.yaml'
      get_logs: True
      labels: 
        task_id: "fpl.allocate"
        dag_id: "test_pipeonce"
      cmds: [ 
        "python", 
        "/home/app/wishpost_payment_pipeline/exp_entrypoint/dosql.py",
      ]
      arguments : [
        "--date={{ execution_date.strftime('%Y-%m-%dT%H:%M:%S%z') }}",
        "--biz_type=fpl",
        "--tbl_type=allocate",
        "--public=True"
      ]
      dependencies: [fpl.allocate_raw]
    lcl_124.from_order_raw:
      operator: airflow.providers.cncf.kubernetes.operators.kubernetes_pod.KubernetesPodOperator
      pod_template_file: '/opt/airflow/dags/repo/pod_template_files/payment_pipeline.yaml'
      get_logs: True
      labels: 
        task_id: "lcl_124.from_order_raw"
        dag_id: "test_pipeonce"
      cmds: [ 
        "python", 
        "/home/app/wishpost_payment_pipeline/exp_entrypoint/dosql.py",
      ]
      arguments : [
        "--date={{ execution_date.strftime('%Y-%m-%dT%H:%M:%S%z') }}",
        "--biz_type=lcl_124",
        "--tbl_type=from_order_raw",
      ]
    lcl_124.refund_origin:
      operator: airflow.providers.cncf.kubernetes.operators.kubernetes_pod.KubernetesPodOperator
      pod_template_file: '/opt/airflow/dags/repo/pod_template_files/payment_pipeline.yaml'
      get_logs: True
      labels: 
        task_id: "lcl_124.refund_origin"
        dag_id: "test_pipeonce"
      cmds: [ 
        "python", 
        "/home/app/wishpost_payment_pipeline/exp_entrypoint/dosql.py",
      ]
      arguments : [
        "--date={{ execution_date.strftime('%Y-%m-%dT%H:%M:%S%z') }}",
        "--biz_type=lcl_124",
        "--tbl_type=refund_origin",
        "--public=True"
      ]
    lcl_124.from_order:
      operator: airflow.providers.cncf.kubernetes.operators.kubernetes_pod.KubernetesPodOperator
      pod_template_file: '/opt/airflow/dags/repo/pod_template_files/payment_pipeline.yaml'
      get_logs: True
      labels: 
        task_id: "lcl_124.from_order"
        dag_id: "test_pipeonce"
      cmds: [ 
        "python", 
        "/home/app/wishpost_payment_pipeline/exp_entrypoint/dosql.py",
      ]
      arguments : [
        "--date={{ execution_date.strftime('%Y-%m-%dT%H:%M:%S%z') }}",
        "--biz_type=lcl_124",
        "--tbl_type=from_order",
      ]
      dependencies: [recon_task.allocate, lcl_124.from_order_raw]
    lcl_124.mapping:
      operator: airflow.providers.cncf.kubernetes.operators.kubernetes_pod.KubernetesPodOperator
      pod_template_file: '/opt/airflow/dags/repo/pod_template_files/payment_pipeline.yaml'
      get_logs: True
      labels: 
        task_id: "lcl_124.mapping"
        dag_id: "test_pipeonce"
      cmds: [ 
        "python", 
        "/home/app/wishpost_payment_pipeline/exp_entrypoint/dosql.py",
      ]
      arguments : [
        "--date={{ execution_date.strftime('%Y-%m-%dT%H:%M:%S%z') }}",
        "--biz_type=lcl_124",
        "--tbl_type=mapping",
      ]
    lcl_124.allocate_raw:
      operator: airflow.providers.cncf.kubernetes.operators.kubernetes_pod.KubernetesPodOperator
      pod_template_file: '/opt/airflow/dags/repo/pod_template_files/payment_pipeline.yaml'
      get_logs: True
      labels: 
        task_id: "lcl_124.allocate_raw"
        dag_id: "test_pipeonce"
      cmds: [ 
        "python", 
        "/home/app/wishpost_payment_pipeline/exp_entrypoint/dosql.py",
      ]
      arguments : [
        "--date={{ execution_date.strftime('%Y-%m-%dT%H:%M:%S%z') }}",
        "--biz_type=lcl_124",
        "--tbl_type=allocate_raw",
        "--public=True"
      ]
      dependencies: [lcl_124.mapping, lcl_124.refund_origin]
    lcl_124.allocate:
      operator: airflow.providers.cncf.kubernetes.operators.kubernetes_pod.KubernetesPodOperator
      pod_template_file: '/opt/airflow/dags/repo/pod_template_files/payment_pipeline.yaml'
      get_logs: True
      labels: 
        task_id: "lcl_124.allocate"
        dag_id: "test_pipeonce"
      cmds: [ 
        "python", 
        "/home/app/wishpost_payment_pipeline/exp_entrypoint/dosql.py",
      ]
      arguments : [
        "--date={{ execution_date.strftime('%Y-%m-%dT%H:%M:%S%z') }}",
        "--biz_type=lcl_124",
        "--tbl_type=allocate",
        "--public=True"
      ]
      dependencies: [lcl_124.allocate_raw]
    recon_task.from_order_raw:
      operator: airflow.providers.cncf.kubernetes.operators.kubernetes_pod.KubernetesPodOperator
      pod_template_file: '/opt/airflow/dags/repo/pod_template_files/payment_pipeline.yaml'
      get_logs: True
      labels: 
        task_id: "recon_task.from_order_raw"
        dag_id: "test_pipeonce"
      cmds: [ 
        "python", 
        "/home/app/wishpost_payment_pipeline/exp_entrypoint/dosql.py",
      ]
      arguments : [
        "--date={{ execution_date.strftime('%Y-%m-%dT%H:%M:%S%z') }}",
        "--biz_type=recon_task",
        "--tbl_type=from_order_raw",
      ]
    recon_task.refund_origin:
      operator: airflow.providers.cncf.kubernetes.operators.kubernetes_pod.KubernetesPodOperator
      pod_template_file: '/opt/airflow/dags/repo/pod_template_files/payment_pipeline.yaml'
      get_logs: True
      labels: 
        task_id: "recon_task.refund_origin"
        dag_id: "test_pipeonce"
      cmds: [ 
        "python", 
        "/home/app/wishpost_payment_pipeline/exp_entrypoint/dosql.py",
      ]
      arguments : [
        "--date={{ execution_date.strftime('%Y-%m-%dT%H:%M:%S%z') }}",
        "--biz_type=recon_task",
        "--tbl_type=refund_origin",
        "--public=True"
      ]
      dependencies: [recon_task.from_order_raw]
    recon_task.mapping:
      operator: airflow.providers.cncf.kubernetes.operators.kubernetes_pod.KubernetesPodOperator
      pod_template_file: '/opt/airflow/dags/repo/pod_template_files/payment_pipeline.yaml'
      get_logs: True
      labels: 
        task_id: "recon_task.mapping"
        dag_id: "test_pipeonce"
      cmds: [ 
        "python", 
        "/home/app/wishpost_payment_pipeline/exp_entrypoint/dosql.py",
      ]
      arguments : [
        "--date={{ execution_date.strftime('%Y-%m-%dT%H:%M:%S%z') }}",
        "--biz_type=recon_task",
        "--tbl_type=mapping",
      ]
      dependencies: [recon_task.from_order_raw]
    recon_task.allocate_raw:
      operator: airflow.providers.cncf.kubernetes.operators.kubernetes_pod.KubernetesPodOperator
      pod_template_file: '/opt/airflow/dags/repo/pod_template_files/payment_pipeline.yaml'
      get_logs: True
      labels: 
        task_id: "recon_task.allocate_raw"
        dag_id: "test_pipeonce"
      cmds: [ 
        "python", 
        "/home/app/wishpost_payment_pipeline/exp_entrypoint/dosql.py",
      ]
      arguments : [
        "--date={{ execution_date.strftime('%Y-%m-%dT%H:%M:%S%z') }}",
        "--biz_type=recon_task",
        "--tbl_type=allocate_raw",
        "--public=True"
      ]
      dependencies: [recon_task.mapping,recon_task.refund_origin]
    recon_task.allocate:
      operator: airflow.providers.cncf.kubernetes.operators.kubernetes_pod.KubernetesPodOperator
      pod_template_file: '/opt/airflow/dags/repo/pod_template_files/payment_pipeline.yaml'
      get_logs: True
      labels: 
        task_id: "recon_task.allocate"
        dag_id: "test_pipeonce"
      cmds: [ 
        "python", 
        "/home/app/wishpost_payment_pipeline/exp_entrypoint/dosql.py",
      ]
      arguments : [
        "--date={{ execution_date.strftime('%Y-%m-%dT%H:%M:%S%z') }}",
        "--biz_type=recon_task",
        "--tbl_type=allocate",
        "--public=True"
      ]
      dependencies: [recon_task.allocate_raw]
